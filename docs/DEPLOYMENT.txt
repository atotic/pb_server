- Setup:
bundle install --binstubs creates bundle binaries inside bin

BINARIES
chromium -- chromium built with pageCapture.saveAsPDF patch
pdftk -- pdf toolkit, for converting to pdf
growl, growlnotify -- development only, growl errors in logs
xvfd -- for running headless chrome

SERVERS
sveg -- main application server
delayed_job -- pdf generation, image resizing, etc
chromium -- custom chromium, converts html -> pdf
pdf_saver_server -- interface to custom chromium
comet -- broadcast protocol
nginx -- front end server
database -- sqlite on development,mysql on production

SERVER DETAILS
	all servers start/stop with script/<server_name> start|stop
	pids are in data_dir/tmp

chromium:
	profile dir is <root>/chromium_profile
	runs pdf_saver_extension that polls pdf_saver_server for work. Turns HTML to PDFs

delayed_job:
	does pdf generation, image resizing
	logs to delayed_job.log (hardcoded in gem)
	
pdf_saver_server:
	

LOGGING
  Logs are in data_dir/log
	Each server has up to three logs:
		<server_name>.log: http access log
		<server_name>.info: LOGGER.info|error|warn output
		<server_name>.stdout: stdout|stderr redirects
	
	
	
TODO
delayed job logger, do the same as pdf_server_saver
refactor streaming
image resizing
nginx
chromium:
	restart when crashes
	run in xvdf on production
	redirect stdout 

NEAT:
Nginx howto https://calomel.org/nginx.html
http://mediumexposure.com/how-i-setup-sinatra-rake-thin-server-and-deployed-it-capistrano-github/
My recipe for Sinatra/Thin/Rack .... http://www.isnorcreative.com/blogs/29

CHROME deployment:

Need strategy how things work on my Mac, vs how they work on Linux
Q: How do I start my server on different ports?
A: Command line for thin http://stackoverflow.com/questions/4389181/passing-options-to-rackup-via-a-sinatra-application

run nginx as a load balancer, have only 1 app server in the back
http://markmaunder.com/2009/12/01/how-to-handle-1000s-of-concurrent-users-on-a-360mb-vps/

http://library.linode.com/web-servers/nginx/configuration/front-end-proxy-and-software-load-balancing

http://www.kalzumeus.com/2010/01/15/deploying-sinatra-on-ubuntu-in-which-i-employ-a-secretary/

http://pemberthy.blogspot.com/2009/02/deploying-sinatra-applications-with.html
http://blog.sosedoff.com/2009/07/04/how-to-deploy-sinatra-merb-applications-with-nginx/

http://library.linode.com/web-servers/nginx/configuration/basic

Code:

thin - delayed_job server:
	- resizing images
	- generating pdfs
thin - sveg app server
thin - comet server
thin - upload server?
database running somewhere...


my setup:
sveg app server
comet: comet server?
delayed_job server. Resizing of images, generating pdfs.
should comet server be another delayed_job server?
